## GraphQL‑схема: обзор

Основная точка входа — единый GraphQL‑endpoint backend‑сервиса (`/graphql`), реализованный через Apollo Server поверх Express.

### 1. Ключевые типы

- **Пользователи**:
  - `User` — базовая информация о пользователе и его ролях.
- **Магазин**:
  - `ProductCategory` — категории товаров.
  - `Product` и `ProductImage` — товары, цены, изображения.
- **Заказы**:
  - `Order`, `OrderItem`, `OrderStatus` — заказы и их позиции.
- **Производство**:
  - `ProductionJob`, `ProductionStatus`, `Printer` — производственные задания и оборудование.
- **Калькулятор**:
  - `PricingInput`, `PricingResult` — ввод и результат расчёта стоимости печати.

Полная SDL‑схема зафиксирована в `api/src/graphql/schema.graphql`.

### 2. Основные запросы (`Query`)

- **Аутентификация**:
  - `me` — текущий пользователь.
  - `users` — список пользователей (для админки).
- **Магазин**:
  - `products(filter)` — список товаров с фильтрацией.
  - `productBySlug(slug)` — карточка товара.
  - `productCategories` — список категорий.
- **Заказы**:
  - `myOrders` — заказы текущего клиента.
  - `orderById(id)` — детали заказа.
- **Производство**:
  - `productionQueue` — очередь производственных заданий.
  - `printers` — список принтеров и их статусов.
- **Справочники**:
  - `materials` — доступные материалы.
- **Системное**:
  - `health` — проверка доступности сервиса.

### 3. Основные мутации (`Mutation`)

- **Аутентификация**:
  - `register`, `login`, `refreshToken`, `logout`.
- **Магазин и заказы**:
  - `createOrder` — создание заказа из корзины/калькулятора.
  - `repeatOrder(orderId)` — повтор существующего заказа.
- **Калькулятор**:
  - `calculatePrice` — расчёт стоимости печати по загруженной модели и параметрам.

Расширенные модули (финансы, CRM, склад, интеграции) могут добавляться в эту схему в следующих итерациях без изменения базового контракта.

